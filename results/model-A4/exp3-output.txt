== Defect Detection in Semiconductor Wafers Using Image Classification ==
[i] Loading dataset from file
[i] Initializing model
[i] Using device: cuda
[i] Using CosineAnnealingWarmRestarts scheduler
[i] Prepare dataloader
[i] Beginning training loop
Epoch [1/200], 	Loss: 0.8582, Accuracy: 0.5673
Epoch [2/200], 	Loss: 0.7637, Accuracy: 0.5986
Epoch [3/200], 	Loss: 0.7320, Accuracy: 0.6167
Epoch [4/200], 	Loss: 0.7126, Accuracy: 0.6238
Epoch [5/200], 	Loss: 0.6851, Accuracy: 0.6340
Epoch [6/200], 	Loss: 0.6695, Accuracy: 0.6402
Epoch [7/200], 	Loss: 0.6573, Accuracy: 0.6430
Epoch [8/200], 	Loss: 0.6453, Accuracy: 0.6541
Epoch [9/200], 	Loss: 0.6389, Accuracy: 0.6519
Epoch [10/200], 	Loss: 0.6280, Accuracy: 0.6587
Epoch [11/200], 	Loss: 0.6264, Accuracy: 0.6595
Epoch [12/200], 	Loss: 0.6664, Accuracy: 0.6381
Epoch [13/200], 	Loss: 0.6434, Accuracy: 0.6506
Epoch [14/200], 	Loss: 0.6405, Accuracy: 0.6504
Epoch [15/200], 	Loss: 0.6147, Accuracy: 0.6599
Epoch [16/200], 	Loss: 0.6034, Accuracy: 0.6662
Epoch [17/200], 	Loss: 0.5873, Accuracy: 0.6719
Epoch [18/200], 	Loss: 0.5796, Accuracy: 0.6803
Epoch [19/200], 	Loss: 0.5747, Accuracy: 0.6759
Epoch [20/200], 	Loss: 0.5728, Accuracy: 0.6773
Epoch [21/200], 	Loss: 0.5717, Accuracy: 0.6810
Epoch [22/200], 	Loss: 0.5559, Accuracy: 0.6864
Epoch [23/200], 	Loss: 0.5544, Accuracy: 0.6845
Epoch [24/200], 	Loss: 0.5531, Accuracy: 0.6845
Epoch [25/200], 	Loss: 0.5469, Accuracy: 0.6894
Epoch [26/200], 	Loss: 0.5418, Accuracy: 0.6905
Epoch [27/200], 	Loss: 0.5413, Accuracy: 0.6915
Epoch [28/200], 	Loss: 0.5397, Accuracy: 0.6937
Epoch [29/200], 	Loss: 0.5382, Accuracy: 0.6938
Epoch [30/200], 	Loss: 0.5392, Accuracy: 0.6930
Epoch [31/200], 	Loss: 0.5311, Accuracy: 0.6972
Epoch [32/200], 	Loss: 0.5701, Accuracy: 0.6781
Epoch [33/200], 	Loss: 0.5699, Accuracy: 0.6788
Epoch [34/200], 	Loss: 0.5616, Accuracy: 0.6862
Epoch [35/200], 	Loss: 0.5569, Accuracy: 0.6848
Epoch [36/200], 	Loss: 0.5568, Accuracy: 0.6877
Epoch [37/200], 	Loss: 0.5600, Accuracy: 0.6870
Epoch [38/200], 	Loss: 0.5520, Accuracy: 0.6891
Epoch [39/200], 	Loss: 0.5435, Accuracy: 0.6887
Epoch [40/200], 	Loss: 0.5507, Accuracy: 0.6878
Epoch [41/200], 	Loss: 0.5425, Accuracy: 0.6941
Epoch [42/200], 	Loss: 0.5459, Accuracy: 0.6914
Epoch [43/200], 	Loss: 0.5359, Accuracy: 0.6953
Epoch [44/200], 	Loss: 0.5338, Accuracy: 0.6967
Epoch [45/200], 	Loss: 0.5343, Accuracy: 0.6934
Epoch [46/200], 	Loss: 0.5295, Accuracy: 0.7031
Epoch [47/200], 	Loss: 0.5259, Accuracy: 0.6972
Epoch [48/200], 	Loss: 0.5237, Accuracy: 0.7016
Epoch [49/200], 	Loss: 0.5159, Accuracy: 0.7062
Epoch [50/200], 	Loss: 0.5224, Accuracy: 0.6984
Epoch [51/200], 	Loss: 0.5234, Accuracy: 0.7050
Epoch [52/200], 	Loss: 0.5092, Accuracy: 0.7094
Epoch [53/200], 	Loss: 0.5119, Accuracy: 0.7096
Epoch [54/200], 	Loss: 0.5093, Accuracy: 0.7104
Epoch [55/200], 	Loss: 0.5076, Accuracy: 0.7088
Epoch [56/200], 	Loss: 0.4939, Accuracy: 0.7136
Epoch [57/200], 	Loss: 0.5013, Accuracy: 0.7153
Epoch [58/200], 	Loss: 0.5028, Accuracy: 0.7109
Epoch [59/200], 	Loss: 0.5047, Accuracy: 0.7124
Epoch [60/200], 	Loss: 0.4955, Accuracy: 0.7156
Epoch [61/200], 	Loss: 0.4941, Accuracy: 0.7173
Epoch [62/200], 	Loss: 0.4962, Accuracy: 0.7157
Epoch [63/200], 	Loss: 0.4958, Accuracy: 0.7196
Epoch [64/200], 	Loss: 0.4922, Accuracy: 0.7186
Epoch [65/200], 	Loss: 0.4847, Accuracy: 0.7212
Epoch [66/200], 	Loss: 0.4932, Accuracy: 0.7202
Epoch [67/200], 	Loss: 0.4877, Accuracy: 0.7172
Epoch [68/200], 	Loss: 0.4844, Accuracy: 0.7228
Epoch [69/200], 	Loss: 0.4860, Accuracy: 0.7230
Epoch [70/200], 	Loss: 0.4885, Accuracy: 0.7240
Epoch [71/200], 	Loss: 0.4866, Accuracy: 0.7272
Epoch [72/200], 	Loss: 0.5181, Accuracy: 0.7050
Epoch [73/200], 	Loss: 0.5239, Accuracy: 0.7043
Epoch [74/200], 	Loss: 0.5199, Accuracy: 0.7046
Epoch [75/200], 	Loss: 0.5185, Accuracy: 0.7073
Epoch [76/200], 	Loss: 0.5189, Accuracy: 0.7014
Epoch [77/200], 	Loss: 0.5206, Accuracy: 0.7034
Epoch [78/200], 	Loss: 0.5127, Accuracy: 0.7065
Epoch [79/200], 	Loss: 0.5189, Accuracy: 0.7070
Epoch [80/200], 	Loss: 0.5200, Accuracy: 0.7025
Epoch [81/200], 	Loss: 0.5059, Accuracy: 0.7121
Epoch [82/200], 	Loss: 0.5116, Accuracy: 0.7076
Epoch [83/200], 	Loss: 0.5152, Accuracy: 0.7055
Epoch [84/200], 	Loss: 0.5117, Accuracy: 0.7096
Epoch [85/200], 	Loss: 0.5106, Accuracy: 0.7104
Epoch [86/200], 	Loss: 0.5025, Accuracy: 0.7089
Epoch [87/200], 	Loss: 0.5042, Accuracy: 0.7133
Epoch [88/200], 	Loss: 0.4968, Accuracy: 0.7179
Epoch [89/200], 	Loss: 0.5082, Accuracy: 0.7106
Epoch [90/200], 	Loss: 0.5027, Accuracy: 0.7143
Epoch [91/200], 	Loss: 0.4986, Accuracy: 0.7153
Epoch [92/200], 	Loss: 0.4960, Accuracy: 0.7166
Epoch [93/200], 	Loss: 0.4958, Accuracy: 0.7184
Epoch [94/200], 	Loss: 0.4995, Accuracy: 0.7185
Epoch [95/200], 	Loss: 0.5018, Accuracy: 0.7151
Epoch [96/200], 	Loss: 0.4914, Accuracy: 0.7182
Epoch [97/200], 	Loss: 0.4909, Accuracy: 0.7232
Epoch [98/200], 	Loss: 0.4941, Accuracy: 0.7206
Epoch [99/200], 	Loss: 0.4887, Accuracy: 0.7216
Epoch [100/200], 	Loss: 0.4998, Accuracy: 0.7174
Epoch [101/200], 	Loss: 0.4957, Accuracy: 0.7212
Epoch [102/200], 	Loss: 0.4959, Accuracy: 0.7181
Epoch [103/200], 	Loss: 0.4886, Accuracy: 0.7230
Epoch [104/200], 	Loss: 0.4910, Accuracy: 0.7210
Epoch [105/200], 	Loss: 0.4826, Accuracy: 0.7282
Epoch [106/200], 	Loss: 0.4826, Accuracy: 0.7219
Epoch [107/200], 	Loss: 0.4773, Accuracy: 0.7303
Epoch [108/200], 	Loss: 0.4885, Accuracy: 0.7225
Epoch [109/200], 	Loss: 0.4816, Accuracy: 0.7282
Epoch [110/200], 	Loss: 0.4827, Accuracy: 0.7242
Epoch [111/200], 	Loss: 0.4803, Accuracy: 0.7253
Epoch [112/200], 	Loss: 0.4832, Accuracy: 0.7254
Epoch [113/200], 	Loss: 0.4782, Accuracy: 0.7270
Epoch [114/200], 	Loss: 0.4770, Accuracy: 0.7306
Epoch [115/200], 	Loss: 0.4792, Accuracy: 0.7289
Epoch [116/200], 	Loss: 0.4794, Accuracy: 0.7318
Epoch [117/200], 	Loss: 0.4768, Accuracy: 0.7283
Epoch [118/200], 	Loss: 0.4690, Accuracy: 0.7354
Epoch [119/200], 	Loss: 0.4740, Accuracy: 0.7292
Epoch [120/200], 	Loss: 0.4713, Accuracy: 0.7337
Epoch [121/200], 	Loss: 0.4766, Accuracy: 0.7299
Epoch [122/200], 	Loss: 0.4730, Accuracy: 0.7315
Epoch [123/200], 	Loss: 0.4645, Accuracy: 0.7345
Epoch [124/200], 	Loss: 0.4658, Accuracy: 0.7355
Epoch [125/200], 	Loss: 0.4712, Accuracy: 0.7298
Epoch [126/200], 	Loss: 0.4703, Accuracy: 0.7362
Epoch [127/200], 	Loss: 0.4691, Accuracy: 0.7364
Epoch [128/200], 	Loss: 0.4728, Accuracy: 0.7330
Epoch [129/200], 	Loss: 0.4682, Accuracy: 0.7372
Epoch [130/200], 	Loss: 0.4712, Accuracy: 0.7330
Epoch [131/200], 	Loss: 0.4660, Accuracy: 0.7340
Epoch [132/200], 	Loss: 0.4632, Accuracy: 0.7369
Epoch [133/200], 	Loss: 0.4630, Accuracy: 0.7380
Epoch [134/200], 	Loss: 0.4588, Accuracy: 0.7361
Epoch [135/200], 	Loss: 0.4678, Accuracy: 0.7375
Epoch [136/200], 	Loss: 0.4592, Accuracy: 0.7412
Epoch [137/200], 	Loss: 0.4586, Accuracy: 0.7375
Epoch [138/200], 	Loss: 0.4660, Accuracy: 0.7356
Epoch [139/200], 	Loss: 0.4665, Accuracy: 0.7398
Epoch [140/200], 	Loss: 0.4588, Accuracy: 0.7380
Epoch [141/200], 	Loss: 0.4555, Accuracy: 0.7404
Epoch [142/200], 	Loss: 0.4484, Accuracy: 0.7431
Epoch [143/200], 	Loss: 0.4595, Accuracy: 0.7421
Epoch [144/200], 	Loss: 0.4639, Accuracy: 0.7363
Epoch [145/200], 	Loss: 0.4627, Accuracy: 0.7395
Epoch [146/200], 	Loss: 0.4643, Accuracy: 0.7355
Epoch [147/200], 	Loss: 0.4703, Accuracy: 0.7317
Epoch [148/200], 	Loss: 0.4610, Accuracy: 0.7387
Epoch [149/200], 	Loss: 0.4564, Accuracy: 0.7387
Epoch [150/200], 	Loss: 0.4639, Accuracy: 0.7352
Epoch [151/200], 	Loss: 0.4641, Accuracy: 0.7400
Epoch [152/200], 	Loss: 0.4840, Accuracy: 0.7258
Epoch [153/200], 	Loss: 0.4811, Accuracy: 0.7302
Epoch [154/200], 	Loss: 0.4875, Accuracy: 0.7256
Epoch [155/200], 	Loss: 0.4842, Accuracy: 0.7257
Epoch [156/200], 	Loss: 0.4818, Accuracy: 0.7254
Epoch [157/200], 	Loss: 0.4839, Accuracy: 0.7255
Epoch [158/200], 	Loss: 0.4829, Accuracy: 0.7266
Epoch [159/200], 	Loss: 0.4694, Accuracy: 0.7301
Epoch [160/200], 	Loss: 0.4727, Accuracy: 0.7307
Epoch [161/200], 	Loss: 0.4620, Accuracy: 0.7353
Epoch [162/200], 	Loss: 0.4740, Accuracy: 0.7300
Epoch [163/200], 	Loss: 0.4701, Accuracy: 0.7296
Epoch [164/200], 	Loss: 0.4702, Accuracy: 0.7341
Epoch [165/200], 	Loss: 0.4624, Accuracy: 0.7387
Epoch [166/200], 	Loss: 0.4564, Accuracy: 0.7392
Epoch [167/200], 	Loss: 0.4561, Accuracy: 0.7395
Epoch [168/200], 	Loss: 0.4622, Accuracy: 0.7367
Epoch [169/200], 	Loss: 0.4684, Accuracy: 0.7316
Epoch [170/200], 	Loss: 0.4553, Accuracy: 0.7414
Epoch [171/200], 	Loss: 0.4640, Accuracy: 0.7366
Epoch [172/200], 	Loss: 0.4560, Accuracy: 0.7424
Epoch [173/200], 	Loss: 0.4665, Accuracy: 0.7377
Epoch [174/200], 	Loss: 0.4621, Accuracy: 0.7341
Epoch [175/200], 	Loss: 0.4613, Accuracy: 0.7400
Epoch [176/200], 	Loss: 0.4604, Accuracy: 0.7370
Epoch [177/200], 	Loss: 0.4669, Accuracy: 0.7365
Epoch [178/200], 	Loss: 0.4586, Accuracy: 0.7393
Epoch [179/200], 	Loss: 0.4634, Accuracy: 0.7352
Epoch [180/200], 	Loss: 0.4640, Accuracy: 0.7367
Epoch [181/200], 	Loss: 0.4663, Accuracy: 0.7369
Epoch [182/200], 	Loss: 0.4595, Accuracy: 0.7424
Epoch [183/200], 	Loss: 0.4633, Accuracy: 0.7378
Epoch [184/200], 	Loss: 0.4543, Accuracy: 0.7421
Epoch [185/200], 	Loss: 0.4516, Accuracy: 0.7414
Epoch [186/200], 	Loss: 0.4583, Accuracy: 0.7410
Epoch [187/200], 	Loss: 0.4645, Accuracy: 0.7391
Epoch [188/200], 	Loss: 0.4651, Accuracy: 0.7390
Epoch [189/200], 	Loss: 0.4569, Accuracy: 0.7401
Epoch [190/200], 	Loss: 0.4647, Accuracy: 0.7363
Epoch [191/200], 	Loss: 0.4670, Accuracy: 0.7321
Epoch [192/200], 	Loss: 0.4625, Accuracy: 0.7329
Epoch [193/200], 	Loss: 0.4615, Accuracy: 0.7371
Epoch [194/200], 	Loss: 0.4541, Accuracy: 0.7405
Epoch [195/200], 	Loss: 0.4589, Accuracy: 0.7405
Epoch [196/200], 	Loss: 0.4584, Accuracy: 0.7408
Epoch [197/200], 	Loss: 0.4599, Accuracy: 0.7372
Epoch [198/200], 	Loss: 0.4612, Accuracy: 0.7392
Epoch [199/200], 	Loss: 0.4599, Accuracy: 0.7401
Epoch [200/200], 	Loss: 0.4591, Accuracy: 0.7372
[i] Model training complete and saved.
[i] Total training time: 01:55:20
[i] Running model on test set
	Accuracy: 71.8394%
	F1 Score: 0.7099
	Avg Inference Time/batch: 0.0065 seconds
	Per-Class Accuracy Report:
              precision    recall  f1-score   support

   Edge-Ring       0.89      0.77      0.83      1126
      Center       0.70      0.73      0.71       832
    Edge-Loc       0.70      0.89      0.79      2772
         Loc       0.69      0.51      0.58      1973
      Random       0.87      0.68      0.76       257
     Scratch       0.59      0.63      0.61       693
       Donut       0.56      0.21      0.31       146
   Near-full       0.94      0.83      0.88        95

    accuracy                           0.72      7894
   macro avg       0.74      0.66      0.68      7894
weighted avg       0.72      0.72      0.71      7894

